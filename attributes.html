<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Character Attributes</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            text-align: center;
            transition: opacity 0.5s ease; /* Animation for fade effect */
        }

        .fade-out {
            opacity: 0; /* Fades out when the reset is triggered */
        }

        .attribute-container, .name-input, .navigation-buttons {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        .attribute {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100px;
        }

        .attribute label {
            margin-bottom: 5px;
            font-size: 0.9em;
        }

        .button-group {
            display: flex;
            gap: 3px;
            margin-top: 5px;
        }

        .attribute-button {
            width: 30px;
            height: 30px;
            font-size: 1em;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .attribute-button:hover {
            background-color: #0056b3;
        }

        .points-remaining {
            margin: 20px;
            font-size: 1em;
            color: #007BFF;
        }

        .button {
            margin: 5px;
            padding: 10px 20px;
            font-size: 1em;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .button:hover {
            background-color: #0056b3;
        }

        .button[disabled] {
            background-color: #ccc;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <h1>Character Attributes</h1>
    
    <div class="name-input">
        <label for="characterName">Enter your character's name:</label>
        <input type="text" id="characterName" placeholder="Name">
    </div>
    
    <div class="points-remaining">Points Remaining: <span id="pointsRemaining">20</span></div>

    <div class="attribute-container">
        <div class="attribute">
            <label for="strength">Strength</label>
            <div class="button-group">
                <button class="attribute-button" id="decrease-strength">-</button>
                <input type="number" id="strength" value="0" readonly style="width: 40px; text-align: center;">
                <button class="attribute-button" id="increase-strength">+</button>
            </div>
        </div>
        <div class="attribute">
            <label for="dexterity">Dexterity</label>
            <div class="button-group">
                <button class="attribute-button" id="decrease-dexterity">-</button>
                <input type="number" id="dexterity" value="0" readonly style="width: 40px; text-align: center;">
                <button class="attribute-button" id="increase-dexterity">+</button>
            </div>
        </div>
        <div class="attribute">
            <label for="intelligence">Intelligence</label>
            <div class="button-group">
                <button class="attribute-button" id="decrease-intelligence">-</button>
                <input type="number" id="intelligence" value="0" readonly style="width: 40px; text-align: center;">
                <button class="attribute-button" id="increase-intelligence">+</button>
            </div>
        </div>
        <div class="attribute">
            <label for="endurance">Endurance</label>
            <div class="button-group">
                <button class="attribute-button" id="decrease-endurance">-</button>
                <input type="number" id="endurance" value="0" readonly style="width: 40px; text-align: center;">
                <button class="attribute-button" id="increase-endurance">+</button>
            </div>
        </div>
        <div class="attribute">
            <label for="constitution">Constitution</label>
            <div class="button-group">
                <button class="attribute-button" id="decrease-constitution">-</button>
                <input type="number" id="constitution" value="0" readonly style="width: 40px; text-align: center;">
                <button class="attribute-button" id="increase-constitution">+</button>
            </div>
        </div>
    </div>

    <div class="navigation-buttons">
        <button class="button" id="backstoryButton">Go to Backstory</button>
        <button class="button" id="skillsButton">Go to Skills</button>
        <button class="button" id="resetButton">Reset</button>
        <button class="button" id="startGameButton" disabled>Start Game</button> <!-- New Start Game button -->
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const pointsTotal = 20;
            let pointsRemaining = pointsTotal;

            const attributes = {
                strength: 0,
                dexterity: 0,
                intelligence: 0,
                endurance: 0,
                constitution: 0
            };

            const pointsRemainingDisplay = document.getElementById('pointsRemaining');
            const backstoryButton = document.getElementById('backstoryButton');
            const skillsButton = document.getElementById('skillsButton');
            const resetButton = document.getElementById('resetButton'); 
            const startGameButton = document.getElementById('startGameButton'); // Start Game button reference
            const nameInput = document.getElementById('characterName');

            function updatePoints(attribute, change) {
                if (pointsRemaining - change >= 0 && attributes[attribute] + change >= 0 && attributes[attribute] + change <= 20) {
                    attributes[attribute] += change;
                    pointsRemaining -= change;
                    document.getElementById(attribute).value = attributes[attribute];
                    pointsRemainingDisplay.textContent = pointsRemaining;
                    saveCharacterData();
                    checkAllConditions(); // Check conditions after each update
                }
            }

            function resetCharacter() {
                document.body.classList.add('fade-out'); // Add fade-out class
                setTimeout(() => {
                    localStorage.removeItem('character'); // Clear stored data
                    pointsRemaining = pointsTotal;
                    pointsRemainingDisplay.textContent = pointsRemaining;
                    nameInput.value = '';
                    for (let key in attributes) {
                        attributes[key] = 0;
                        document.getElementById(key).value = 0;
                    }
                    document.body.classList.remove('fade-out'); // Remove fade-out class after reset
                    checkAllConditions(); // Check conditions after reset
                }, 500); // Delay to allow fade-out effect
            }

            function checkAllConditions() {
                const savedCharacter = JSON.parse(localStorage.getItem('character')) || {};
                const allPointsUsed = pointsRemaining === 0;
                const hasName = nameInput.value.trim() !== '';
                const hasBackstory = savedCharacter.backstory && savedCharacter.backstory.trim() !== '';

                startGameButton.disabled = !(allPointsUsed && hasName && hasBackstory); // Enable button if all conditions are met
            }

            document.getElementById('increase-strength').addEventListener('click', () => updatePoints('strength', 1));
            document.getElementById('decrease-strength').addEventListener('click', () => updatePoints('strength', -1));
            document.getElementById('increase-dexterity').addEventListener('click', () => updatePoints('dexterity', 1));
            document.getElementById('decrease-dexterity').addEventListener('click', () => updatePoints('dexterity', -1));
            document.getElementById('increase-intelligence').addEventListener('click', () => updatePoints('intelligence', 1));
            document.getElementById('decrease-intelligence').addEventListener('click', () => updatePoints('intelligence', -1));
            document.getElementById('increase-endurance').addEventListener('click', () => updatePoints('endurance', 1));
            document.getElementById('decrease-endurance').addEventListener('click', () => updatePoints('endurance', -1));
            document.getElementById('increase-constitution').addEventListener('click', () => updatePoints('constitution', 1));
            document.getElementById('decrease-constitution').addEventListener('click', () => updatePoints('constitution', -1));

            resetButton.addEventListener('click', resetCharacter); // Add event listener to reset button
            startGameButton.addEventListener('click', function () {
                window.location.href = 'game.html'; // Redirect to the game.html page
            });

            nameInput.addEventListener('input', function () {
                saveCharacterData();
                checkAllConditions(); // Check conditions on name input
            });

            // Load saved character data
            const savedCharacter = JSON.parse(localStorage.getItem('character')) || {};
            if (savedCharacter.name) {
                nameInput.value = savedCharacter.name;
            }
            if (savedCharacter.attributes) {
                Object.keys(savedCharacter.attributes).forEach(attr => {
                    document.getElementById(attr).value = savedCharacter.attributes[attr];
                    attributes[attr] = savedCharacter.attributes[attr];
                    pointsRemaining -= attributes[attr];
                });
                pointsRemainingDisplay.textContent = pointsRemaining;
            }

            function saveCharacterData() {
                const characterData = {
                    name: nameInput.value.trim(),
                    attributes
                };
                localStorage.setItem('character', JSON.stringify(characterData));
            }

            backstoryButton.addEventListener('click', function () {
                window.location.href = 'backstory.html';
            });

            skillsButton.addEventListener('click', function () {
                window.location.href = 'skills.html';
            });

            // Initial check on page load
            checkAllConditions();
        });
    </script>
</body>
</html>
